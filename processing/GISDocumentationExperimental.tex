\documentclass[openany]{book}  % Use a real document class for the main

\input{preamble}
\input{glossaryEntries}
\input{indexEntries}

\usepackage{standalone} %
\usepackage[a5paper,vmargin=2cm]{geometry}
\usepackage{background}
\usepackage{etoolbox}
\usepackage{totcount}
\usepackage{lipsum}
\setcounter{tocdepth}{5}  % subparagraph and down
%\setcounter{tocdepth}{4}  % paragraph and down
%\setcounter{tocdepth}{3}  % subsubPart and down
%\setcounter{tocdepth}{2}  % Sets Table of Contents level to show subParts, Parts, chapters, and parts(DEFAULT)
%\setcounter{tocdepth}{1}  % Sets Table of Contents level to show Parts, chapters, and parts
%\setcounter{tocdepth}{0}  % Sets Table of Contents level to show chapters, and parts

\def\titlename{What We Do} % Sets book title
\title{\input{commonTitle}}  % closing brace for title
\makeglossaries % creates glo file
\makeindex % Creates idx file




% to have access to the total number of Parts
\regtotcounter{part}

% every Part starts on a new page
%\pretocmd{\part}{\clearpage}{}{}

% auxiliary lengths for the height of the frame and the width of each tab
\newlength\mylen
\newlength\mylena



%	Styling the tabs
% style for the Part tabs
\tikzset{
tab/.style={
  text width=\mylena,
  draw=gray,
  thick,
  rectangle,
  rounded corners=12pt,
  align=center,
  text width=53pt,
  inner sep=0pt,
  fill=gray!20,
  font=\sffamily\LARGE
  }
}
% style for the current Part tab
\tikzset{selectedtab/.style={tab,color=white,fill=gray!90}}

% the page number is showed in the background material
\pagestyle{empty}

\AtBeginDocument{
% calculation of the width for each tab
\setlength\mylen{\dimexpr\textheight+2cm\relax}
\ifnum\totvalue{part}>0
\setlength\mylena{\dimexpr\mylen/\totvalue{part}\relax}
\fi

% the main part; as background material we place the border,
% the Part (current and other) tabs and the page number
\backgroundsetup{
scale=1,
color=black,
angle=0,
opacity=1,
contents= {
  \begin{tikzpicture}[remember picture, overlay]
  \node[
    inner sep=0pt,
    text width=\the\dimexpr\textwidth+1.5cm\relax
  ]
    at (current page.center) (border) {\rule{0pt}{\dimexpr\textheight+2cm\relax}};
  \foreach \valpart in {0,...,\numexpr\totvalue{part}-1\relax}
  {
    \node[
      \ifnum\thepart<\numexpr\valpart+1\relax
        tab%
      \else
      \ifnum\thepart>\numexpr\valpart+1\relax
        tab%
      \else selectedtab%
      \fi\fi,
      minimum height=\mylena
      ]
      at ([yshift=-(0.5+\valpart)*\mylena]border.north east)
      (tab-\valpart)
      {\hspace*{25pt}\rotatebox{-90}{%
        \hyperlink{part:\valpart}{part \the\numexpr\valpart+1\relax}%
        }
      };
  }
  \node[
    draw=gray,
    line width=2pt,
    rectangle,
    rounded corners=10pt,
    inner sep=0pt,
    text width=\the\dimexpr\textwidth+1.5cm\relax,
    fill=white
  ]
    at (current page.center)
    {\rule{0pt}{\dimexpr\textheight+2cm\relax}};
  \node[font=\LARGE\sffamily,fill=white]
    at (border.south)
    {\makebox[3em][c]{\thepage}};
\end{tikzpicture}}
  }
}

%--------------------
%		Front Part
%--------------------
\begin{document}% Document Begins

%\frontmatter % turns off chapter numbering and uses roman numerals for page numbers

%\maketitle % creates title page and blank page after title page

%\tableofcontents % creates TOC

%-------------------
%		Main Part
%-------------------
%\mainmatter % turns on chapter numbering, resets page numbering and uses arabic numerals for page numbers

%\part*{Introduction} % * makes this part unnumbered

\part{Brand} % Creates Book Part.  (Title page, blank page, then 1st chapter)
\hypertarget{part:0}{}
\subimport{brandPart/}{awardsChapter.tex}

\part{Methods}
\hypertarget{part:1}{}
\subimport{methodPart/}{documentationChapter.tex}
\subimport{methodPart/}{teamConceptChapter.tex}

\part{Service}
\hypertarget{part:2}{}
\subimport{servicePart/}{applicationsChapter.tex}
\subimport{servicePart/}{toolsChapter.tex}

%-------------------
%		Back Part
%-------------------

\part{Resources}
\hypertarget{part:3}{}
\subimport{resourcesPart/}{appendices.tex}

\backmatter % does \clearpage

\addcontentsline{toc}{part}{References} % Adds references to TOC as a part

\bibliographystyle{amsplain} % sets biblioigraphy style
%\bibliographystyle{plain} % sets biblioigraphy style
\bibliography{referenceEntries} % Puts bibliography here

\addcontentsline{toc}{part}{Glossary} % add glassary to TOC as a Part
\glsaddall % Includes all glossary entries whether they appear in the text or not
\printglossaries % Puts glossaries here

\addcontentsline{toc}{part}{Index} % Adds Index to TOC as a part

\printindex % Puts index here

\end{document} % Document Ends
